/*! wee-promise - 0.2.0 - Bernard McManus - g993c26 - 2014-11-29 */
!function(a){var b=this;"object"==typeof exports?module.exports=a:(b.WeePromise=a,b.Promise=b.Promise||a)}(function(a){function b(a){var b=this;j([t,u,s],function(a){b[a]=[]}),g(function(){b.caught=!!i(b[u]),h(b,function(){a(c(b,t),c(b,u))}),b[x]=!0})}function c(a,b){function c(d){g(a[x]?function(){a[m]||a[w](b,d)[w](s,d)}:function(){c(d)})}return c}function d(a,b,c,d,g){return function(){a=a.map(function(b,c){return f(b[n])?b[n]:a[c]});var h=e(a,1),j=e(a,-1);if(i(h)===d){var k=h.map(function(a){return a[n][0]});b(g?k[0]:k)}else i(j)>0&&c(j[0][n][0])}}function e(a,b){return a.filter(function(a){return a[m]===b})}function f(a){return a instanceof b}function g(b){a(b,1)}function h(a,b){try{return b()}catch(c){return a[w](u,c)}}function i(a){return a.length}function j(a,b){a.forEach(b)}var k,l=(function(){try{var a=require("util");return function(){var b=Array.prototype.slice.call(arguments,0);b=b.map(function(b){return a.inspect.apply(a,[b,{colors:!0,depth:3}])}),console.log.apply(console,b)}}catch(b){return function(){var a=Array.prototype.slice.call(arguments,0);console.log.apply(console,a)}}}(),"prototype"),m="state",n="args",o="always",p="then",q="catch",r="pass",s="_"+o,t="_"+p,u="_"+q,v="_add",w="_exec",x="_ready",y={};return y[t]=1,y[u]=-1,b[l][v]=function(a,b){var c=this;return b&&c[a].push(b),c},b[l][w]=function(a,b){var c,d,e=this,g=e[a],j=i(g),l=0;return h(e,function(){for(;j>l;){if(c=y[a]?g.shift():g[l],d=c.apply(k,[b]),b=y[a]?d:b,f(d)&&y[a])return e[m]=y[a]||e[m],e[r](d,a);if(a==u&&e.caught&&e.isChild)return e[w](t,d);if(a==u)break;l++}return e[n]=e[m]?e[n]:[b],e[m]=y[a]||e[m],a!==u||!e.caught||e.isChild&&!e.isList||(e[m]=y[t]),e})},b[l][o]=function(a){return this[v](s,a)},b[l][p]=function(a,b){return this[v](t,a)[q](b)},b[l][q]=function(a){return this[v](u,a)},b[l][r]=function(a,b){var c=this;return c.isChild=!0,j([t,u,s],function(d){a[d]=d!==b?a[d].concat(c[d]):c[d]}),c[n]=a,a},b.all=function(a){j(a,function(a){a.isMember=!0});var c=new b(function(b,e){c.isList=!0,j(a,function(c){c[o](d(a,b,e,i(a)))})});return c},b.race=function(a){j(a,function(a){a.isMember=!0});var c=new b(function(b,e){c.isList=!0,j(a,function(c){c[o](d(a,b,e,1,!0))})});return c},b}(setTimeout));