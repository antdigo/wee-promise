/*! wee-promise - 1.0.6 - Bernard McManus - 4a1cdaa - 2016-10-25 */
!function(a,b){"use strict";function c(){var a=this;a.q=[],a.i=0,a.len=0}function d(a){var b=this,d=i(function(a,c){a(b,c)});if(b._state=m,b._stack=new c,b.resolve=function(a){return d(e,a),b},b.reject=function(a){return d(f,a),b},a)try{a(b.resolve,b.reject)}catch(g){b.reject(g)}}function e(a,b){b===a?f(a,new TypeError("A promise cannot be resolved with itself.")):h(b,function(b,c){g(a,b,c)})}function f(a,b){g(a,o,b)}function g(a,b,c){a._state!=b&&(a._value=c,a._state=b,a._flush())}function h(a,c){if(a instanceof d&&a._state)c(a._state,a._value);else if(j(a)||k(a)){var e,f=i(function(a,c){a.apply(b,c)});try{e=a.then,k(e)?e.call(a,function(a){f(h,[a,c])},function(a){f(c,[o,a])}):f(c,[n,a])}catch(g){f(c,[o,g])}}else c(n,a)}function i(a){var c;return function(){c||(a.apply(b,arguments),c=!0)}}function j(a){return a&&"object"==typeof a}function k(a){return"function"==typeof a}c.prototype.put=function(a){var b=this;b.q[b.len]=a,b.len++},c.prototype.get=function(){var a=this,b=a.q[a.i];return a.i++,a.i>=a.len&&(a.q.length=a.i=a.len=0),b};var l;l=a.setImmediate?setImmediate:a.MessageChannel?function(){var a=new c,b=new MessageChannel;return b.port1.onmessage=function(){for(var b;b=a.get();)b()},function(c){a.put(c),b.port2.postMessage(0)}}():setTimeout,d.async=function(a){l(a)};var m=0,n=1,o=2;d.prototype.onresolved=function(a){return a},d.prototype.onrejected=function(a){throw a},d.prototype._flush=function(){var a=this,b=a._state;b&&d.async(function(){!function c(){var d=a._stack.get();if(d){var g=b===n?d.onresolved:d.onrejected;try{e(d,g(a._value))}catch(h){f(d,h)}c()}}()})},d.prototype.then=function(a,b){var c=this,e=new d;return k(a)&&(e.onresolved=a),k(b)&&(e.onrejected=b),c._stack.put(e),c._flush(),e},d.prototype["catch"]=function(a){return this.then(b,a)},d.resolve=function(a){return(new d).resolve(a)},d.reject=function(a){return(new d).reject(a)},d.all=function(a){var b=new d,c=[],e=0,f=a.length;return a.forEach(function(a,d){h(a,function(a,g){e++,c[d]=g,a===o?b.reject(g):e===f&&b.resolve(c)})}),b},d.race=function(a){var b=new d;return a.forEach(function(a){h(a,function(a,c){g(b,a,c)})}),b},"object"==typeof exports?module.exports=d:a.WeePromise=d}("object"==typeof window?window:global);