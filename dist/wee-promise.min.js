/*! wee-promise - 0.3.0 - Bernard McManus - nightly - g8aa544 - 2015-04-27 */
(function(a,b,c){"use strict";function d(){f(p?g:q?h:r?i:j)}function e(){return n(l)}function f(a){a?n=a:d()}function g(a){return function(){setImmediate(a)}}function h(a){var b=0,c=new MutationObserver(a),d=document.createTextNode("");return c.observe(d,{characterData:!0}),function(){d.data=b=++b%2}}function i(a){var b=new MessageChannel;return b.port1.onmessage=a,function(){b.port2.postMessage(0)}}function j(a){return function(){b(a,1)}}function k(a,b){t[u]=a,t[u+1]=b,u+=2,2==u&&e()()}function l(){for(var a,b,d=0;u>d;d+=2){a=t[d],b=t[d+1],t[d]=c,t[d+1]=c;try{a(b)}catch(e){m(e)}}u=0}function m(a){v.push(a),j(function(){var a=v.shift();if(a!==c)throw console.error(a.stack||a),a})()}var n,o=typeof global!=""+c?global:window,p=function(){var a=o.setImmediate;return a?a:!1}(),q=function(){var a=o.MutationObserver;return a?a:!1}(),r=function(){var a=o.MessageChannel,b=o.Uint8ClampedArray;return b&&a?a:!1}(),s={nextTick:g,observer:h,worker:i,timeout:j},t=a(1024),u=0,v=[],w=k;w.providers=s,w.use=f,f();var x=w;"object"==typeof exports?module.exports=x:this.briskit=x}).apply(this,[Array,setTimeout]),window.WeePromise=function(a){"use strict";function b(b){var e=this;e._state=0,e._queue=[],e._watchers=[],e._args=h,a(function(){e._args=d(e,function(){b(c(e,1),c(e,-1))}),e._state<0&&e.__flush()})}function c(a,b){return function(c){a._state||(a._args=c,a._state=b,a.__flush())}}function d(a,b){try{return b(a._args)}catch(c){return a._state=-1,c}}function e(a,b){for(var c;g(a);)if(c=a.shift(),c.state==b)return c}function f(a,b){return a instanceof b}function g(a){return a.length}var h;return b.prototype={then:function(a){return this.__enqueue({state:1,func:a})},"catch":function(a){return this.__enqueue({state:-1,func:a})},_watch:function(a){a._watchers.push(this)},_notify:function(){for(var a,b=this,c=b._watchers;g(c);)a=c.shift(),a._args=b._args,a.__flush()},__enqueue:function(a){return this._queue.push(a),this},__flush:function(){var a,c=this,g=e(c._queue,c._state);g?(a=d(c,g.func),f(a,b)?c._watch(a):(c._args=a,c.__flush())):c._notify()}},b}(briskit);